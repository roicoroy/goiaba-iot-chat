"use strict";var express=require("express"),app=express(),cors=require("cors"),randomColor=require("randomcolor"),uuid=require("uuid");app.disable("x-powered-by"),app.use(express.static("client")),app.get("/",function(e,n){n.sendFile(__dirname+"/client/index.html")}),server=app.use(cors).listen(process.env.PORT||5e3,function(){console.log("server running"+process.env.PORT)});var io=require("socket.io")(server),users=[],connnections=[];io.on("connection",function(r){console.log("New user connected"),connnections.push(r);var e=randomColor();r.username="Anonymous",r.color=e,r.on("change_username",function(e){var n=uuid.v4();r.id=n,r.username=e.nickName,users.push({id:n,username:r.username,color:r.color}),o()});var o=function(){io.sockets.emit("get users",users)};r.on("new_message",function(e){io.sockets.emit("new_message",{message:e.message,username:r.username,color:r.color})}),r.on("typing",function(e){r.broadcast.emit("typing",{username:r.username})}),r.on("disconnect",function(e){if(r.username){for(var n=void 0,s=0;s<users.length;s++)if(users[s].id===r.id){n=users[s];break}users=users.filter(function(e){return e!==n}),o(),connnections.splice(connnections.indexOf(r),1)}})});
//# sourceMappingURL=app.min.js.map
